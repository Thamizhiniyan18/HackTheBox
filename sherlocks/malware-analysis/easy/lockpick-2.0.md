---
description: >-
  Lockpick 2.0 HackTheBox Malware Analysis Sherlocks Writeup by Thamizhiniyan C
  S
---

# Lockpick 2.0

## Sherlock Scenario

Forela needs your help! A whole portion of our UNIX servers have been hit with what we think is ransomware. We are refusing to pay the attackers and need you to find a way to recover the files provided. Warning This is a warning that this Sherlock includes software that is going to interact with your computer and files. This software has been intentionally included for educational purposes and is NOT intended to be executed or used otherwise. Always handle such files in isolated, controlled, and secure environments. Once the Sherlock zip has been unzipped, you will find a DANGER.txt file. Please read this to proceed.

{% embed url="https://app.hackthebox.com/sherlocks/Lockpick2.0" %}

***

## Setting up the Environment

First download the given file and extract it. The password for the given zip file is `hacktheblue`.

<figure><img src="../../../.gitbook/assets/image (25).png" alt=""><figcaption></figcaption></figure>

The given zip file has another zip file and a `DANGER.txt` file as shown in the following image. The `DANGER.txt` file contains the password for the `malware.zip` file.

<figure><img src="../../../.gitbook/assets/image (26).png" alt=""><figcaption></figcaption></figure>

The password for `malware.zip` file is `&PD8LhraU1hx`.

<figure><img src="../../../.gitbook/assets/image (27).png" alt=""><figcaption></figcaption></figure>

***

## Task 1

### Question

What type of encryption has been utilised to encrypt the files provided?

### Solution



<figure><img src="../../../.gitbook/assets/image (28).png" alt=""><figcaption></figcaption></figure>

```bash
strings update
```

<figure><img src="../../../.gitbook/assets/image (29).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../../.gitbook/assets/image (30).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../../.gitbook/assets/image (31).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../../.gitbook/assets/image (32).png" alt=""><figcaption></figcaption></figure>



<figure><img src="../../../.gitbook/assets/image (33).png" alt=""><figcaption></figcaption></figure>





**Answer:** `AES`

***

## Task 2

### Question

Which market is our CEO planning on expanding into? (Please answer with the wording utilised in the PDF)

### Solution



**Answer:** &#x20;

***

## Task 3

### Question

Please confirm the name of the bank our CEO would like to takeover?

### Solution



**Answer:**&#x20;

***

## Task 4

### Question

What is the file name of the key utlised by the attacker?

### Solution



**Answer:**&#x20;

***

## Task 5

### Question

What is the file hash of the key utilised by the attacker?

### Solution



**Answer:**&#x20;

***

## Task 6

### Question

What is the BTC wallet address the TA is asking for payment to?

### Solution



[https://pastebin.ai/raw/foiawsmlsk](https://pastebin.ai/raw/foiawsmlsk)

<figure><img src="../../../.gitbook/assets/image (34).png" alt=""><figcaption></figcaption></figure>



**Answer:** `1BvBMSEYstWetqTFn5Au4m4GFg7xJaNVN2`

***

## Task 7

### Question

How much is the TA asking for?

### Solution



**Answer:**&#x20;

***

## Task 8

### Question

What was used to pack the malware?

### Solution



**Answer:** `upx`
